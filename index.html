<!DOCTYPE html>
<html>
  <script>window.$ = window.jQuery = require('jquery');</script>
  <script>window.semantic = require('semantic-ui-css');</script>
  <head>
    <meta charset="UTF-8">
    <title>Feed My Pi</title>
    <link rel="stylesheet" type ="text/css" href ="./node_modules/semantic-ui-css/semantic.min.css" />
    <link rel="stylesheet" type ="text/css" href ="./customStyle.css" />
  </head>
  <body>
    <div class="ui middle aligned center aligned grid">
      <img class="ui image" id="image-stage-one" src=""/>
      <img class="ui image" id="image-stage-two" src=""/>
    </div>
  </body>
  <script type="text/javascript" src="./displayFeed.js"></script>
  <script type="text/javascript">

    let subreddit = 'me_irl';

    function isImageUrl(url) {
      const validExtensions = ['jpg', 'png', 'svg', 'jpeg'];
      for (i in validExtensions) {
        if (url.toLowerCase().includes('.' + validExtensions[i])) {
          return true;
        }
      }
      return false;
    }

    $.get('https://www.reddit.com/r/' + subreddit + '.json').done((response) => { 
      let images = [];
      response.data.children.forEach((post) => {
        let url = post.data.url;
        if (url && isImageUrl(url)) {
          // filter out non image/non displayable posts
          images.push(url);
        }
      })
      displayImages(images);
    });
  </script>
</html>